<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>5&nbsp; Correlation, Regression and Causation – Statistics Notes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./DealingWithDataSets.html" rel="next">
<link href="./descriptive_stats.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-70a47bd5681a7291082a5b9f83d58762.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="include/webex.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./CorrelationRegressionCausation.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Correlation, Regression and Causation</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Statistics Notes</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datatypes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Types</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./graphical_descriptive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Graphical Descriptive Statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./descriptive_stats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Numerical Descriptive Statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./CorrelationRegressionCausation.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Correlation, Regression and Causation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./DealingWithDataSets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Dealing with real life datasets</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./IntroToProbability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Introducing Probability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#descriptive-statistics-for-the-relation-between-two-or-more-variables" id="toc-descriptive-statistics-for-the-relation-between-two-or-more-variables" class="nav-link active" data-scroll-target="#descriptive-statistics-for-the-relation-between-two-or-more-variables"><span class="header-section-number">5.1</span> Descriptive statistics for the relation between two or more variables</a></li>
  <li><a href="#correlation" id="toc-correlation" class="nav-link" data-scroll-target="#correlation"><span class="header-section-number">5.2</span> Correlation</a>
  <ul class="collapse">
  <li><a href="#additional-resources" id="toc-additional-resources" class="nav-link" data-scroll-target="#additional-resources"><span class="header-section-number">5.2.1</span> Additional resources</a></li>
  </ul></li>
  <li><a href="#regression" id="toc-regression" class="nav-link" data-scroll-target="#regression"><span class="header-section-number">5.3</span> Regression</a>
  <ul class="collapse">
  <li><a href="#naming-conventions-and-causation" id="toc-naming-conventions-and-causation" class="nav-link" data-scroll-target="#naming-conventions-and-causation"><span class="header-section-number">5.3.1</span> Naming Conventions and Causation</a></li>
  </ul></li>
  <li><a href="#transformations-of-data" id="toc-transformations-of-data" class="nav-link" data-scroll-target="#transformations-of-data"><span class="header-section-number">5.4</span> Transformations of data</a></li>
  <li><a href="#worked-example" id="toc-worked-example" class="nav-link" data-scroll-target="#worked-example"><span class="header-section-number">6</span> Worked Example</a>
  <ul class="collapse">
  <li><a href="#additional-resources-1" id="toc-additional-resources-1" class="nav-link" data-scroll-target="#additional-resources-1"><span class="header-section-number">6.1</span> Additional resources</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Correlation, Regression and Causation</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="descriptive-statistics-for-the-relation-between-two-or-more-variables" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="descriptive-statistics-for-the-relation-between-two-or-more-variables"><span class="header-section-number">5.1</span> Descriptive statistics for the relation between two or more variables</h2>
<p>When we considered graphical ways to describe data we already considered the situation of having more than two variables. Very common graphical representations in such situations are line graphs (with multiple lines) when dealing with time series data or scatter plots when dealing with cross-sectional data. In particular scatter plots allowed us to visualise how two series were related to each other.</p>
<p>Here we replicate a scatter plot used in an earlier section. This plot illustrates how the country level 14-day covid case rate (in 2022, Week 10) relates to the countries Health expenditure as a share of the countries GDP.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/scatter_covid_healthex.png" class="img-fluid figure-img"></p>
<figcaption>Scatter diagram, Health expenditure as percentage of GDP and 14-day Covid case rate, as per Week 10 in 2022.</figcaption>
</figure>
</div>
<p>It is somewhat difficult to see from this plot whether there was indeed a positive relationship between these two variables or not. In fact there are three aspects of a potential relationship you may be interested in. First, is it a positive or negative relationship, second, whether it appears to be a linear or nonlinear relationship and third, how strong is that relationship. In this section you will learn how to find numerical descriptive statistics that that speak to these aspects of such a relationship.</p>
<p>This video provides a short introduction to correlation</p>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/cNyIMCjMvBA" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
</section>
<section id="correlation" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="correlation"><span class="header-section-number">5.2</span> Correlation</h2>
<p>A commonly used measure of association is the <strong>sample correlation coefficient</strong>, which is designed to tell us something about the characteristics of a scatter plot of observations on the variable <span class="math inline">\(Y\)</span> against observations on the variable <span class="math inline">\(X\)</span>. In particularly, are higher than average values of <span class="math inline">\(Y\)</span> associated with higher than average values of <span class="math inline">\(X\)</span>, and vice-versa? In the context of the above example we would ask whether higher values of health expenditure (as % of GDP) are related to higher Covid infection rates.</p>
<p>Consider the following data-set in which we observe the weight (<span class="math inline">\(Y_i\)</span>) measured in pounds and the height (<span class="math inline">\(X_i\)</span>) measured in inches of a sample of 12 people:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 14%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
<td>9</td>
<td>10</td>
<td>11</td>
<td>12</td>
</tr>
<tr class="even">
<td>Weight <span class="math inline">\(=Y_i\)</span></td>
<td>155</td>
<td>150</td>
<td>180</td>
<td>135</td>
<td>156</td>
<td>168</td>
<td>178</td>
<td>160</td>
<td>132</td>
<td>145</td>
<td>139</td>
<td>152</td>
</tr>
<tr class="odd">
<td>Height <span class="math inline">\(=X_i\)</span></td>
<td>70</td>
<td>63</td>
<td>72</td>
<td>60</td>
<td>66</td>
<td>70</td>
<td>74</td>
<td>65</td>
<td>62</td>
<td>67</td>
<td>65</td>
<td>68</td>
</tr>
</tbody>
</table>
<p>The best way to graphically represent the data is the following scatter plot:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/regression_scatter1.jpg" class="img-fluid figure-img"></p>
<figcaption>Scatter diagram, Weight and Height.</figcaption>
</figure>
</div>
<p>On this graph a horizontal line at <span class="math inline">\(y=154.1667\)</span> (at the sample mean <span class="math inline">\(\bar{y}\)</span>) and also a vertical line at <span class="math inline">\(x=66.8333\)</span> (at the sample mean <span class="math inline">\(\bar{x}\)</span>) are superimposed. This creates four areas. Points in the upper right quadrant are those for which the weight is higher than average <strong>and</strong> height is higher than average. One of these points (Observation <span class="math inline">\(i=3\)</span> with <span class="math inline">\(y_i=180, x_i=72\)</span>) is highlighted in the scatter plot along with its deviations from <span class="math inline">\(\bar{x}\)</span> and <span class="math inline">\(\bar{y}\)</span>.</p>
<p>Points in the lower left quadrant are those for which weight is lower than average <strong>and</strong> height is lower than average. Since most points lie in these two quadrants, this suggests that higher than average weight is associated with higher than average height; whilst lower than average weight is associated with lower than average height. This is typical for a positive relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>. If there was no association, we would expect to see a roughly equal distribution of points in all four quadrants.</p>
<p>While it is often straightforward to see the qualitative nature of a relationship (positive, negative or unrelated) we want a numerical measure that describes this relationship such that we can also comment on the strength of the relationship. The basis of such a measure are again the deviations from the sample mean (as for the calculation of the variance and standard deviation), but now we have two such deviations for each observation, the deviation in the <span class="math inline">\(Y\)</span> variable, <span class="math inline">\(d_{y,i}=(y_i-\bar{y})\)</span>, and the deviation in the <span class="math inline">\(X\)</span> variable, <span class="math inline">\(d_{x,i}=(x_i-\bar{x})\)</span>. These are the deviations you can see in the above Figure.</p>
<p>In the case of the third observation with <span class="math inline">\(y_3=180\)</span> and <span class="math inline">\(x_3=72\)</span> we can see that both values are larger than the respective sample means <span class="math inline">\(\bar{y}\)</span> and <span class="math inline">\(\bar{x}\)</span> and therefore both, <span class="math inline">\(d_{y,i}\)</span> and <span class="math inline">\(d_{x,i}\)</span> are positive. \ <span class="math inline">\(d_{y,i}=(y_i-\bar{y})\)</span> = 180-154.1667 = 25.8333\ <span class="math inline">\(d_{x,i}=(x_i-\bar{x})\)</span> = 72-66.8333 = 5.1667</p>
<p>In fact this will be the case for all observations that lie in the <strong>upper right</strong> quadrant. For observations in the <strong>lower left</strong> quadrant we will find <span class="math inline">\(d_{y,i}\)</span> and <span class="math inline">\(d_{x,i}\)</span> to be smaller than 0. Observations in both these quadrants are reflective of a positive relationship. We therefore need to use the information in <span class="math inline">\(d_{y,i}\)</span> and <span class="math inline">\(d_{x,i}\)</span> in such a way that in both these cases we get a positive contribution to our statistic that numerically describes the relationship. Consider the term <span class="math inline">\((d_{y,i} \cdot d_{x,i})\)</span>; this term will be positive for all observations in either the <strong>upper right</strong> or <strong>lower left</strong> quadrant. For values in either the <strong>upper left</strong> or <strong>lower right</strong> quadrant, however, the terms <span class="math inline">\(d_{y,i}\)</span> and <span class="math inline">\(d_{x,i}\)</span> will have different signs and hence the term <span class="math inline">\((d_{y,i} \cdot d_{x,i})\)</span> will be negative, reflective of the fact that observations in these quadrants are representative of a negative relationship.</p>
<p>It should now be no surprise to find that our numerical measure of a relationship between two variables is based on these terms. In particular we will use what is called the sample covariance:</p>
<p><span class="math display">\[\begin{equation*}
    Cov(X,Y)=s_{X,Y}=\frac{1}{n-1}\sum_{i=1}^{n}\left( x_{i}-\bar{x}\right) \left( y_{i}-\bar{y}\right) =\frac{1}{n-1}\sum_{i=1}^{n} d_{x,i} d_{y,i}
\end{equation*}\]</span></p>
<p>You can see that this is the sum of <span class="math inline">\(d_{y,i}d_{x,i}\)</span> divided by <span class="math inline">\(n-1\)</span>. The reason for dividing by <span class="math inline">\(n-1\)</span> and not <span class="math inline">\(n\)</span> is similar to the reasoning used for the sample variance. In fact the measure that we typically use is the :</p>
<p><span class="math display">\[\begin{eqnarray*}
    Corr(X,Y)=r_{XY}&amp;=&amp;\frac{s_{X,Y} }{\sqrt{s^2_X s^2_Y}}\\
    &amp;=&amp; \frac{\frac{1}{n-1}\sum_{i=1}^{n}\left( x_{i}-\bar{x}\right) \left( y_{i}-\bar{y}\right) }{\sqrt{\frac{1}{n-1}\sum_{i=1}^{n}\left( x_{i}-\bar{x}\right)^{2}\,\frac{1}{n-1}\sum_{i=1}^{n}\left( y_{i}-\bar{y}\right) ^{2}}}\\
    &amp;=&amp; \frac{\sum_{i=1}^{n}\left( x_{i}-\bar{x}\right) \left( y_{i}-\bar{y}\right) }{\sqrt{\sum_{i=1}^{n}\left( x_{i}-\bar{x}\right)^{2}\,\sum_{i=1}^{n}\left( y_{i}-\bar{y}\right) ^{2}}}\\
\end{eqnarray*}\]</span></p>
<p>It is the sample covariance divided by the square root of the product of the two sample variances. In the last line we merely cancelled out the <span class="math inline">\(1/(n-1)\)</span> terms.</p>
<section id="excel-application" class="level4 callout-info" data-number="5.2.0.1">
<h4 data-number="5.2.0.1" class="anchored" data-anchor-id="excel-application"><span class="header-section-number">5.2.0.1</span> Excel application</h4>
<p>The calculations are best done in a Table format or using Excel.</p>
<p>This video shows the calculations by hand (YouTube, 21min)</p>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/xMDjtzT1G_w" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
<p>This video shows the calculations by Excel (YouTube, 11min)</p>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/YdtXe2vkKrw" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
<table class="caption-top table">
<caption>Table illustrating the calculations required to calculate a covariance. Values rounded to 4dp.</caption>
<colgroup>
<col style="width: 3%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th>Obs</th>
<th>Weight (Y)</th>
<th>Height (X)</th>
<th><span class="math inline">\(y_i-\bar{y}\)</span></th>
<th><span class="math inline">\(x_i-\bar{x}\)</span></th>
<th><span class="math inline">\((y_i-\bar{y})^2\)</span></th>
<th><span class="math inline">\((x_i-\bar{x})^2\)</span></th>
<th><span class="math inline">\((y_i-\bar{y})(x_i-\bar{x})\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>155</td>
<td>70</td>
<td>0.8333</td>
<td>3.1667</td>
<td>0.6944</td>
<td>10.0278</td>
<td>2.6389</td>
</tr>
<tr class="even">
<td>2</td>
<td>150</td>
<td>63</td>
<td>-4.1667</td>
<td>-3.8333</td>
<td>17.3611</td>
<td>14.6944</td>
<td>15.9722</td>
</tr>
<tr class="odd">
<td>3</td>
<td>180</td>
<td>72</td>
<td>25.8333</td>
<td>5.1667</td>
<td>667.3611</td>
<td>26.6944</td>
<td>133.4722</td>
</tr>
<tr class="even">
<td>4</td>
<td>135</td>
<td>60</td>
<td>-19.1667</td>
<td>-6.8333</td>
<td>367.3611</td>
<td>46.6944</td>
<td>130.9722</td>
</tr>
<tr class="odd">
<td>5</td>
<td>156</td>
<td>66</td>
<td>1.8333</td>
<td>-0.8333</td>
<td>3.3611</td>
<td>0.6944</td>
<td>-1.5278</td>
</tr>
<tr class="even">
<td>6</td>
<td>168</td>
<td>70</td>
<td>13.8333</td>
<td>3.1667</td>
<td>191.3611</td>
<td>10.0278</td>
<td>43.8056</td>
</tr>
<tr class="odd">
<td>7</td>
<td>178</td>
<td>74</td>
<td>23.8333</td>
<td>7.1667</td>
<td>568.0278</td>
<td>51.3611</td>
<td>170.8056</td>
</tr>
<tr class="even">
<td>8</td>
<td>160</td>
<td>65</td>
<td>5.8333</td>
<td>-1.8333</td>
<td>34.0278</td>
<td>3.3611</td>
<td>-10.6944</td>
</tr>
<tr class="odd">
<td>9</td>
<td>132</td>
<td>62</td>
<td>-22.1667</td>
<td>-4.8333</td>
<td>491.3611</td>
<td>23.3611</td>
<td>107.1389</td>
</tr>
<tr class="even">
<td>10</td>
<td>145</td>
<td>67</td>
<td>-9.1667</td>
<td>0.1667</td>
<td>84.0278</td>
<td>0.0278</td>
<td>-1.5278</td>
</tr>
<tr class="odd">
<td>11</td>
<td>139</td>
<td>65</td>
<td>-15.1667</td>
<td>-1.8333</td>
<td>230.0278</td>
<td>3.3611</td>
<td>27.8056</td>
</tr>
<tr class="even">
<td>12</td>
<td>152</td>
<td>68</td>
<td>-2.1667</td>
<td>1.1667</td>
<td>4.6944</td>
<td>1.3611</td>
<td>-2.5278</td>
</tr>
<tr class="odd">
<td>Sum</td>
<td>1850</td>
<td>802</td>
<td>0</td>
<td>0</td>
<td>2659.6667</td>
<td>191.6667</td>
<td>616.3333</td>
</tr>
</tbody>
</table>
<p>If you calculate <span class="math inline">\(r\)</span> for the above example you should obtain a value of</p>
<p><span class="math display">\[\begin{equation*}
    Corr(X,Y)=r_{XY}=\frac{616.3333}{\sqrt{2659.6667 \cdot 191.6667}} = 0.8632
\end{equation*}\]</span></p>
</section>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Complete the table below and calculate, sample means, sample variances and standard deviations, the sample covariance and the correlation for the following four observations of <span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span>.</p>
<table class="caption-top table">
<caption>Table for correlation calculations.</caption>
<colgroup>
<col style="width: 3%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th>Obs</th>
<th>Weight (Y)</th>
<th>Height (X)</th>
<th><span class="math inline">\(y_i-\bar{y}\)</span></th>
<th><span class="math inline">\(x_i-\bar{x}\)</span></th>
<th><span class="math inline">\((y_i-\bar{y})^2\)</span></th>
<th><span class="math inline">\((x_i-\bar{x})^2\)</span></th>
<th><span class="math inline">\((y_i-\bar{y})(x_i-\bar{x})\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>4</td>
<td>10</td>
<td>-4</td>
<td>6</td>
<td>16</td>
<td>36</td>
<td>-24</td>
</tr>
<tr class="even">
<td>2</td>
<td>8</td>
<td>-2</td>
<td>0</td>
<td>-6</td>
<td>0</td>
<td>36</td>
<td>0</td>
</tr>
<tr class="odd">
<td>3</td>
<td>6</td>
<td>7</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>4</td>
<td>14</td>
<td>1</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Sum</td>
<td>32</td>
<td>16</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p><span class="math inline">\(\bar{y} =\)</span> <input class="webex-solveme nospaces" size="1" data-answer="[&quot;8&quot;]"></p>
<p><span class="math inline">\(\bar{x} =\)</span> <input class="webex-solveme nospaces" size="1" data-answer="[&quot;4&quot;]"></p>
<p><span class="math inline">\(s_Y^2 =\)</span> <input class="webex-solveme nospaces" size="7" data-answer="[&quot;18.6667&quot;]"></p>
<p><span class="math inline">\(s_X^2 =\)</span> <input class="webex-solveme nospaces" size="2" data-answer="[&quot;30&quot;]"></p>
<p><span class="math inline">\(Cov(X,Y) = s_{Y,X} =\)</span> <input class="webex-solveme nospaces" size="3" data-answer="[&quot;-16&quot;]"></p>
<p><span class="math inline">\(Corr(X,Y) = r =\)</span> <input class="webex-solveme nospaces" size="7" data-answer="[&quot;-0.6761&quot;,&quot;-.6761&quot;]"></p>
</div>
</div>
<p>A few things are worth noting with respect to the <strong>correlation coefficient</strong>:</p>
<ul>
<li>It can be shown algebraically that <span class="math inline">\(-1 \leq r \leq 1\)</span>.</li>
<li>Positive (negative) numbers represent a positive (negative) relationship and a value of 0 represents the absence of any relationship. In our Excel application example <span class="math inline">\(r=0.8632\)</span> and hence the two variables display a strong positive correlation.</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/correlation_coefficient.png" class="img-fluid figure-img"></p>
<figcaption>Correlation coefficient, strength and direction.</figcaption>
</figure>
</div>
<ul>
<li>The numerator contains the sum of the discussed cross products <span class="math inline">\(d_{y,i} \cdot d_{x,i}=(y_i-\bar{y})(x_i-\bar{x})\)</span></li>
<li>The term in the denominator of the equation for <span class="math inline">\(r\)</span> is related to the variances of <span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span>. These terms are required to <strong>standardise</strong> the statistic to be between -1 and 1.</li>
<li>For the correlation the order of variables does not matter, i.e.&nbsp;<span class="math inline">\(r_{XY}=r_{YX}\)</span>.</li>
</ul>
<p>The <strong>covariance</strong> is actually also a measure of the relationship between these two variables, but it has many of the same shortcomings as the variance (see the Descriptive Statistics lesson). Therefore we want a standardised measure (to ensure that <span class="math inline">\(-1\leq r \geq 1\)</span>. This standardisation uses the square root of the two respective variances.</p>
<p>There are two very important limitations of the <strong>correlation coefficient</strong>:</p>
<ul>
<li>In general, this sort of analysis does not imply causation, in either direction. Variables may appear to move together for a number of reasons and not because one is causally linked to the other.</li>
</ul>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Caution</span>Correlation, NOT Causation
</div>
</div>
<div class="callout-body-container callout-body">
<p>For example, over the period 1945-64 the number of TV licences <span class="math inline">\((x)\)</span> taken out in the UK increased steadily, as did the number of convictions for juvenile delinquency <span class="math inline">\(\left( y \right)\)</span>. Thus a scatter of <span class="math inline">\(y\)</span> against <span class="math inline">\(x\)</span>, and the construction of the sample correlation coefficient reveals an apparent positive relationship. However, to therefore claim that increased exposure to TV causes juvenile delinquency would be extremely irresponsible.</p>
</div>
</div>
<p>Another example illustrating that correlation must not be mis-interpreted as a causal relationship is that of ice cream sales and shark attacks, illustrated in the following image.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/causation_correlation.png" class="img-fluid figure-img"></p>
<figcaption>Correlation is not causation.</figcaption>
</figure>
</div>
<p>If we were to calculate a correlation between the two series we clearly would obtain a positive correlation. But nobody would suggest that increased ice-cream sales cause shark attacks, or indeed that increased shark attacks caused higher ice cream sales.<br>
Here is a different discussion on this issue:&nbsp;Khan Academy: <a href="www.khanacademy.org/math/probability/regression/regression-correlation/v/correlation-and-causality">Do not confuse correlation with causation</a>.</p>
<ul>
<li>The sample correlation coefficient gives an index of the apparent linear relationship only. It <strong>assumes</strong> that the scatter of points must be distributed about some underlying straight line. This is discussed further below. However, the term relationship is not really confined to such linear relationships.</li>
</ul>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Caution</span>Relationship, NOT Linear Relationship
</div>
</div>
<div class="callout-body-container callout-body">
<p>Consider the relationship between and . If we were to plot observations for the age and income of people in the age range of 20 to 50 we will clearly find a positive relationship. However, if we were to extend the age range to 80, we would most likely see that income decreases at the upper end of the age range. Therefore there is no linear age/income relationship across the full age range and the <strong>correlation coefficient</strong> cannot be used to describe such a relationship.</p>
</div>
</div>
<p>Imagine drawing a straight line of <strong>best fit</strong> through the scatter of points in the above Figure (for height and weight) simply from <strong>visual</strong> inspection. You would try and make it <strong>go through</strong> the scatter, in some way, and it would probably have a positive slope. Numerically, one of the things that the correlation coefficient does is assess the slope of such a line: if <span class="math inline">\(r&gt;0\)</span>, then the slope of the line of best fit should be positive, and vice-versa. Moreover, if <span class="math inline">\(r\)</span> is close to either 1 (or -1) then this implies that the scatter is quite closely distributed around the line of best fit. What the correlation coefficient doesn’t do, however, is tell us the exact position of line of best fit. This is achieved using <strong>regression</strong> analysis.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Scatterplot_correlation.jpeg" class="img-fluid figure-img"></p>
<figcaption>Scatter plots and correlation.</figcaption>
</figure>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Consider the following Figure which displays six scatterplots</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/SixCorrelations.png" class="img-fluid figure-img"></p>
<figcaption>Scatter plots of six bivariate data samples.</figcaption>
</figure>
</div>
<p>Match the correlations to the plots with the correlations. Note that the scales are identical for all plots.:</p>
<p><span class="math inline">\(r_1 = 0.9226\)</span>: Plot <input class="webex-solveme nospaces" size="1" data-answer="[&quot;1&quot;]"> <span class="math inline">\(r_2 = -0.8835\)</span>: Plot <input class="webex-solveme nospaces" size="1" data-answer="[&quot;2&quot;]"> <span class="math inline">\(r_3 = 0.9931\)</span> Plot <input class="webex-solveme nospaces" size="1" data-answer="[&quot;3&quot;]"> <span class="math inline">\(r_4 = -0.9936\)</span> Plot <input class="webex-solveme nospaces" size="1" data-answer="[&quot;4&quot;]"> <span class="math inline">\(r_5 = -0.1988\)</span> Plot <input class="webex-solveme nospaces" size="1" data-answer="[&quot;5&quot;]"> <span class="math inline">\(r_6 = 0.4813\)</span> Plot <input class="webex-solveme nospaces" size="1" data-answer="[&quot;6&quot;]"></p>
<div class="webex-solution">
<button>
Feedback
</button>
<p>The sign of the correlation tells you whether the correlation is positive or negative. The strength of the correlation tells you how close the points are to a straight line (not shown here but in the next section).</p>
<p>It is not straightforward to tell the plots for the last two correlations apart. Plot 6 shows some more points in the top right quadrant and hence is the one with the positive correlation.</p>
</div>
</div>
</div>
<section id="additional-resources" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="additional-resources"><span class="header-section-number">5.2.1</span> Additional resources</h3>
<ul>
<li><a href="https://www.khanacademy.org/math/probability/regression/regression-correlation/v/correlation-and-causality">Khan Academy: Do not confuse correlation with causation</a></li>
</ul>
</section>
</section>
<section id="regression" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="regression"><span class="header-section-number">5.3</span> Regression</h2>
<p>When thinking about correlations you learned that correlation values close to 1 or -1 imply that the points will lie close to an imaginary line, the “line of best fit”. The following image shows the six scatter plots we looked at above but now including the lines of best fit.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/SixCorrelations_wLOBF.png" class="img-fluid figure-img"></p>
<figcaption>Scatter plots of six bivariate data samples and lines of best fit.</figcaption>
</figure>
</div>
<p>The lines of best fit drawn on the scatter can be represented algebraically as <span class="math inline">\(a+bx\)</span>. Here <span class="math inline">\(x\)</span> represents the value on the horizontal axis, <span class="math inline">\(a\)</span> is the intercept (i.e.&nbsp;the value on the vertical axis at <span class="math inline">\(x=0\)</span>) and <span class="math inline">\(b\)</span> is the slope (i.e.&nbsp;the value by which the line increases as we increase <span class="math inline">\(x\)</span> by one unit). The line is defined at any value of <span class="math inline">\(x\)</span> and not only those at which we have actual observations. Here you can see the line of best fit for for sample 1 with an indication of the intercept (<span class="math inline">\(a\)</span>) and the slope (<span class="math inline">\(b\)</span>). For the data in Sample 1 these values are <span class="math inline">\(a=-0.34\)</span> and <span class="math inline">\(b=1.1327\)</span>. Just take these as given for now, you will shortly learn how to calculate these.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Scatter_LOBF_Details.png" class="img-fluid figure-img"></p>
<figcaption>Scatter plot for Sample 1 and line of best fit (red).</figcaption>
</figure>
</div>
<p>When you substitute any of the observed values <span class="math inline">\(x_i\)</span> into the line of best fit you get <span class="math inline">\(\widehat{y}_i=a+bx_i\)</span>. It is important to note that the result of this operation, <span class="math inline">\(\widehat{y}_i\)</span> is not the same as <span class="math inline">\(y_i\)</span>. Let us illustrate this in the above scatter plot. One of the scatter points is for <span class="math inline">\(x_i=6\)</span> and <span class="math inline">\(y_i=9\)</span> (the point is highlighted in red in the next plot.) If we plug in the values for <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>, we get</p>
<p><span class="math display">\[\begin{equation*}
    \widehat{y}_i=a+bx_i = -0.34 + 1.1327 \cdot 6 = 6.4562
\end{equation*}\]</span></p>
<p>The difference between the two is what is often called the residual:</p>
<p><span class="math display">\[\begin{equation*}
    res_i=y_i-\widehat{y}_i =  y_i - (a + bx_i) = y_i - a - bx_i.
\end{equation*}\]</span></p>
<p>Here that residual is <span class="math inline">\(res_i=y_i-\widehat{y}_i =9-6.4562 = 2.538\)</span>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Scatter_LOBF_Details2.png" class="img-fluid figure-img"></p>
<figcaption>Scatter plot for Sample 1, line of best fit and example residual.</figcaption>
</figure>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Calculate the residual for the following two observations:</p>
<ul>
<li><span class="math inline">\(res_1\)</span> for <span class="math inline">\(x_1=2\)</span> and <span class="math inline">\(y_1=3\)</span></li>
<li><span class="math inline">\(res_2\)</span> for <span class="math inline">\(x_2=8\)</span> and <span class="math inline">\(y_2=7.1\)</span> which are both points in the above scatter diagram.</li>
</ul>
<p>You will note that one residual is positive and the other negative. What do these different signs represent in the scatter diagram?</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Scatter_LOBF_details_exercise.png" class="img-fluid figure-img"></p>
<figcaption>Scatter plot for Sample 1, line of best fit and example residual.</figcaption>
</figure>
</div>
<p><span class="math inline">\(res_1 =\)</span> <input class="webex-solveme nospaces" size="6" data-answer="[&quot;1.0746&quot;]"></p>
<p><span class="math inline">\(res_2 =\)</span> <input class="webex-solveme nospaces" size="6" data-answer="[&quot;-1.622&quot;]"></p>
<p>A positive sign for the residual implies that the actual observation lies <select class="webex-select"><option value="blank"></option><option value="">below</option><option value="">on</option><option value="answer">above</option></select> the line of best fit.</p>
<div class="webex-solution">
<button>
Feedback
</button>
<p><span class="math display">\[\begin{equation*}
    res_1=3-\widehat{y}_1 = 3 + 0.34 - 1.1327 \cdot 2 = 3-1.9254 = 1.0746
\end{equation*}\]</span></p>
<p>and</p>
<p><span class="math display">\[\begin{equation*}
    res_2=7.1-\widehat{y}_2 = 7.1 + 0.34 - 1.1327 \cdot 8 = 7.1-8.7216 = -1.6220
\end{equation*}\]</span></p>
<p>If the residual is positive this implies that <span class="math inline">\(y_i&gt;\widehat{y}_i\)</span> and hence that the point <span class="math inline">\(y_i\)</span> is above the regression line. If the residual is negative this implies that <span class="math inline">\(y_i&lt;\widehat{y}_i\)</span> and hence that the point <span class="math inline">\(y_i\)</span> is below the regression line.</p>
</div>
</div>
</div>
<p>Above we used the relationship <span class="math inline">\(res_i= y_i - a - bx_i\)</span> to calculate a residual. Re-arranging this delivers the equation which we will typically use to describe a regression relationship:</p>
<p><span class="math display">\[\begin{equation*}
    y_i = a + b x_i + res_i
\end{equation*}\]</span></p>
<p>where <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> represented the intercept and slope coefficients for a particular line of best fit arising from a particular sample (which is why we call <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> sample estimates - but more on this in the inference section of the course). If we want to write this relationship in a general way, i.e.&nbsp;not specialised on a particular sample, but for the population of our data, then we write:</p>
<p><span class="math display">\[\begin{equation*}
    y_i = \alpha + \beta x_i + \epsilon_i
\end{equation*}\]</span></p>
<p>Here we have replaced the <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> with <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> and the residuals <span class="math inline">\(res_i\)</span> with <span class="math inline">\(\epsilon_i\)</span>. <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> represent the unknown values of the intercept and slope parameters that describe a liner relationship between <span class="math inline">\(y_i\)</span> and <span class="math inline">\(x_i\)</span> in the population. The error terms <span class="math inline">\(\epsilon_i\)</span> now represent error terms acknowledging that, even in the population, the linear relationship will not precisely represent the data.</p>
<p>Only once we have a sample of data (as in the above table) we are able to find a line of best (described by <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>). We should note that this line (and hence the <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> values) is unique to the particular sample. A slightly different sample would have delivered different values for <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>. (Note: This is not unique to a regression relationship. Assume you have a population of values for some random variable <span class="math inline">\(m_i\)</span> with an unknown mean <span class="math inline">\(\mu_m\)</span>. Then you take a sample of values from this population and obtain a sample mean, <span class="math inline">\(\bar{m}\)</span>. Had you taken a different sample, this <span class="math inline">\(\bar{m}\)</span> would also be different.)</p>
<section id="naming-conventions-and-causation" class="level3" data-number="5.3.1">
<h3 data-number="5.3.1" class="anchored" data-anchor-id="naming-conventions-and-causation"><span class="header-section-number">5.3.1</span> Naming Conventions and Causation</h3>
<p>In some sense estimating a regression model is not much different to calculating a correlation between two variables, <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>. When we did talk about correlations we also noted that <span class="math inline">\(r_{XY}=r_{YX}\)</span>, i.e.&nbsp;that the correlation between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> is identical to the correlation between <span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span>.</p>
<p>When undertaking a regression analysis this is not the case. The variables on the left hand side and the right hand side have different functions and therefore we call them by different names, such as dependent variable (on the left) and explanatory variable (on the right).</p>
<p><span class="math display">\[\begin{equation*}
    \underset{\begin{array}{c}
            \textrm{dependent variable}\\
            \textrm{explained variable}\\
            \textrm{outcome variable}
        \end{array}}{y_i} = \alpha + \beta \underset{\begin{array}{c}
        \textrm{independent variable}\\
        \textrm{explanatory variable}
    \end{array}}{x_i} + \epsilon_i
\end{equation*}\]</span></p>
<p>Let’s continue thinking about the relationship between height and weight. Does it matter whether we use height or weight as the dependent variable?</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Which of the two combinations do you think is more sensible? Answer: <input class="webex-solveme nospaces" size="1" data-answer="[&quot;B&quot;]"></p>
<ul>
<li>A: Height = dependent variable and Weight = explanatory variable</li>
<li>B: Weight = dependent variable and Height = explanatory variable</li>
</ul>
<div class="webex-solution">
<button>
Feedback
</button>
<p>Here it is pretty obvious that individuals do have some control over their weight, but that ultimately their weight is to some degree a function of their height. Of course their weight is not solely determined by their height (do not forget their diet and levels of activity), but the height will play a role. Therefore Weight should be the dependent variable and height the explanatory variable.</p>
</div>
</div>
</div>
<p>The important thing to realise here is that it is YOU who has to decide which variable is dependent/explained and which is independent/explanatory. Sometimes this will be fairly obvious, like in the height-weight example, but sometimes it is not. (Is it interest rates which determine inflation or inflation which determines interest rates!!??). In any case, it is you who will have to bring your economic knowledge to the question and decide. The software (like Excel) will calculate regressions either way.</p>
<p>This issue is related to the very big question of whether you can interpret any relationship described by a regression model as a causal relationship. In fact this is such a big question that large parts of 2nd year Econometrics courses will be devoted to this question. There you will learn that this is a fiendishly difficult (and therefore exciting!!!) question. It is for now safe to assume that any regression results you obtain do NOT describe a causal relationship.</p>
<p>So in that sense regression analysis is not much different to calculating correlations. This seems to make the practice of using names like dependent and independent variables invalid. You can use these names as long as you are aware that regression results do not automatically deliver causal results. In fact, Excel will happily calculate results for both of the following regression models</p>
<p><span class="math display">\[\begin{equation*}
    Height_i = \alpha + \beta~ Weight_i + \epsilon_i
\end{equation*}\]</span></p>
<p>and</p>
<p><span class="math display">\[\begin{equation*}
    Weight_i = \gamma + \delta~ Height_i + \epsilon_i
\end{equation*}\]</span></p>
<p>They will produce different (yet related) intercept and slope coefficients which is the reason why we named them differently above. The point is, the software will not be able to tell you which of the two is the sensible way of looking at the data. It is your human understanding of the problem which tells you that only the second makes sense.</p>
<p>### Estimation</p>
<p><strong>Regression</strong> analysis is the statistical technique that finds the <strong>optimal</strong> values for <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> given a particular sample. We will soon see how to determine the best values for <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>. Let us return to the example of 12 observations with height (taking the role of <span class="math inline">\(x\)</span>) and weight (in this example representing <span class="math inline">\(y\)</span>) data. Here is our previous scatter plot without the <strong>line of best fit</strong>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/scatter_heightweight.png" class="img-fluid figure-img"></p>
<figcaption>Scatter diagram, Height and Weight example.</figcaption>
</figure>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<pre><code>\textbf{Exercise}</code></pre>
<p>Draw a line which you think best fits the 12 data points (If you are looking at this on a screen take a ruler and hold it over the points). From your line, what can you say, roughly, about the intercept and slope of that line (only use eye-balling here, we will get to the precise results shortly).</p>
<p>The estimated slope coefficient will be</p>
<div id="radio_QNZBHVQAZH" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_QNZBHVQAZH" value=""> <span>between -3 and -1</span></label><label><input type="radio" autocomplete="off" name="radio_QNZBHVQAZH" value=""> <span>between -1 and 1</span></label><label><input type="radio" autocomplete="off" name="radio_QNZBHVQAZH" value="answer"> <span>between 1 and 5</span></label><label><input type="radio" autocomplete="off" name="radio_QNZBHVQAZH" value=""> <span>between 5 and 10</span></label>
</div>
<p>The estimated intercept coefficient will be</p>
<div id="radio_OVJCRBEECZ" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_OVJCRBEECZ" value=""> <span>between -100 and -70</span></label><label><input type="radio" autocomplete="off" name="radio_OVJCRBEECZ" value="answer"> <span>between -70 and -30</span></label><label><input type="radio" autocomplete="off" name="radio_OVJCRBEECZ" value=""> <span>between -30 and 30</span></label><label><input type="radio" autocomplete="off" name="radio_OVJCRBEECZ" value=""> <span>between 30 and 700</span></label><label><input type="radio" autocomplete="off" name="radio_OVJCRBEECZ" value=""> <span>between 70 and 100</span></label>
</div>
<div class="webex-solution">
<button>
Feedback
</button>
<p>On the graph you cannot see <span class="math inline">\(x=0\)</span>. But when eye-balling the line of best fit it drops by around 60 weight units for a drop of 20 height units. That means that the slope is around 3. For a value of height = 60 the line of best fit has an approximate weight value of 130. If, for every height unit drop the weight drops by about 3, then y should drop by <span class="math inline">\(60 \times 3 = 180\)</span> as x goes from 60 to 0. Hence, the intercept <span class="math inline">\(a\)</span> should be at approximately <span class="math inline">\(130-180 = -50\)</span>. Don’t get confused by the graph only showing x values down to 55.</p>
</div>
</div>
</div>
<p>Let’s now calculate the actual sample estimates <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>. And let’s do that precisely. But don’t forget these values will be specific to that particular sample of 12 observations. We will continue to not know what the true values <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> are and, if we had a different sample we would get somewhat different values for <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>.</p>
<p>Before we do so we want to point out what <strong>optimal</strong> means in this context. In fact it implies that we want to minimise the values for <span class="math inline">\(res_i\)</span> for all <span class="math inline">\(i=1,...,n\)</span> observations in the sample.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/rss.png" class="img-fluid figure-img"></p>
<figcaption>Scatter diagram with linear regression, Height and Weight example.</figcaption>
</figure>
</div>
<p>In fact what we want to minimise is the <strong>sum of squared residuals</strong></p>
<p><span class="math display">\[\begin{equation*}
    (y_{1}-\widehat{y}_{1})^{2}+(y_{2}-\widehat{y}_{2})^{2}+...+(y_{12}-\widehat{y}_{12})^{2}=\sum_{i=1}^{n}(y_{i}-\widehat{y}_{i})^{2} = \sum_{i=1}^{n}(y_{i}-a-bx_{i})^{2}.
\end{equation*}\]</span></p>
<p>This is equivalent to saying that we want to minimise the variation of our sample observations around the regression line (<span class="math inline">\(a+bx\)</span>). The technique of obtaining the best values for <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>, which we call <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>, in this way is also known as <strong>ordinary least squares</strong> (OLS) since it minimises the sum of squared deviations (sum of squared residuals) from the fitted line. We shall not dwell on the algebra here (You have a function and want to chose the <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> such that the function is minimised … two partial derivatives … setting them to 0 … solving for <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> … you know the drill), but the solutions to the algebraical problem are:</p>
<p><span class="math display">\[\begin{equation*}
    b=\frac{\sum_{i=1}^{n}(x_{i}-\bar{x})(y_{i}-\bar{y})}{\sum_{i=1}^{n}(x_{i}-\bar{x})^{2}},\quad a=\bar{y}-b\bar{x};
\end{equation*}\]</span></p>
<p>Here, as earlier, <span class="math inline">\(\bar{y}\)</span> and <span class="math inline">\(\bar{x}\)</span> are the sample means of variables <span class="math inline">\(y\)</span> and <span class="math inline">\(x\)</span>. Applying the technique to the weight and height data yields <span class="math inline">\(b=616.3333/191.6667=3.2157\)</span>, and <span class="math inline">\(a=154.1667-3.2157\cdot 66.8333=-60.7491\)</span>. All the numbers we need here were calculated in the earlier Table for this example. This gives the smallest possible sum of squared residuals as <span class="math inline">\(677.753\)</span>, a value which is not so easily read of the table. The regression line (line of best fit) is therefore defined as:</p>
<p><span class="math display">\[\begin{equation*}
    \hat{y}=-60.7491+3.2157 \times x
\end{equation*}\]</span></p>
<p>It turns out that this line should be quite close to the line of best fit I asked you to draw earlier. As it turns out our eyes are pretty good in <strong>visual fitting</strong>. This is particularly easy if you have the sample means of <span class="math inline">\(\bar{y}\)</span> and <span class="math inline">\(\bar{x}\)</span> available, as the line of best fit will always go through the point <span class="math inline">\({\bar{y}, \bar{x}}\)</span>.</p>
<section id="excel-application-1" class="level4 callout-info" data-number="5.3.1.1">
<h4 data-number="5.3.1.1" class="anchored" data-anchor-id="excel-application-1"><span class="header-section-number">5.3.1.1</span> Excel application</h4>
<p>Video illustrating the estimation of a simple linear regression in Excel (YouTube, 6min).</p>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/ecq4DGSZkLA" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
<p>When estimating the regression by EXCEL, the results are presented as follows:</p>
<p><img src="images/EXCEL_Reg1.png" class="img-fluid" alt="EXCEL Regression Output."> You can recognise that the sample estimates for the intercept and the slope appear in that regression output (highlighted in yellow). We will interpret a number of further values from that output as we go along. There is one which you should already recognise: The sample size (Observations) of 12. Another one, a little less obvious is the value of 2659.667. It appears here as “SS Total” or Sum of Squares Total. Find that value in the Table from which we calculated the correlation for this data set, it is <span class="math inline">\(\sum_{i=1}^{12}(y_{i}-\bar{y})^{2}\)</span>. It measures the amount of variation we can see in the dependent variable. What we want to achieve by using regression analysis is to explain some of this variation through <span class="math inline">\(y\)</span>’s linear relationship with <span class="math inline">\(x\)</span>.</p>
<p>You can see from the regression output that here 74.5% of that variation is explained by that linear relationship (see the “R square” statistic at the top of the output.)</p>
</section>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Which of the following are equivalent to the OLS estimator <span class="math inline">\(b\)</span>? Answer TRUE if equivalent.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Formula</th>
<th style="text-align: right;">answer</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(b=\frac{\sum_{i=1}^{n}(x_{i}-\bar{x})(y_{i}-\bar{y})}{\sum_{i=1}^{n}(x_{i}-\bar{x})(x_{i}-\bar{x})}\)</span></td>
<td style="text-align: right;"><select class="webex-select"><option value="blank"></option><option value="answer">TRUE</option><option value="">FALSE</option></select></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(b=\frac{n\sum_{i=1}^{n}(x_{i}-\bar{x})(y_{i}-\bar{y})}{n^{-1}\sum_{i=1}^{n}(x_{i}-\bar{x})^{2}}\)</span></td>
<td style="text-align: right;"><select class="webex-select"><option value="blank"></option><option value="">TRUE</option><option value="answer">FALSE</option></select></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(b=\frac{n^{-1}\sum_{i=1}^{n}(x_{i}-\bar{x})(y_{i}-\bar{y})}{n^{-1}\sum_{i=1}^{n}(x_{i}-\bar{x})^{2}}\)</span></td>
<td style="text-align: right;"><select class="webex-select"><option value="blank"></option><option value="answer">TRUE</option><option value="">FALSE</option></select></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(b=\frac{(n-1)^{-1}\sum_{i=1}^{n}(x_{i}-\bar{x})(y_{i}-\bar{y})}{(n-1)^{-1}\sum_{i=1}^{n}(x_{i}-\bar{x})^{2}}\)</span></td>
<td style="text-align: right;"><select class="webex-select"><option value="blank"></option><option value="answer">TRUE</option><option value="">FALSE</option></select></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(b=\frac{Cov(X,Y)}{s_X^2}\)</span></td>
<td style="text-align: right;"><select class="webex-select"><option value="blank"></option><option value="answer">TRUE</option><option value="">FALSE</option></select></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(b=\frac{Cov(X,Y)~s_Y}{s_Y~s_X^2}\)</span></td>
<td style="text-align: right;"><select class="webex-select"><option value="blank"></option><option value="answer">TRUE</option><option value="">FALSE</option></select></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(b=Corr(X,Y)~\frac{s_Y}{s_X}\)</span></td>
<td style="text-align: right;"><select class="webex-select"><option value="blank"></option><option value="answer">TRUE</option><option value="">FALSE</option></select></td>
</tr>
</tbody>
</table>
<div class="webex-solution">
<button>
Hint
</button>
<p>All but the second are equivalent. Use the definitions of sample covariance, correlation and standard deviations to confirm.</p>
</div>
<ol start="2" type="1">
<li>Earlier in this lesson you calculated a number of statistics for a sample of <span class="math inline">\(n=4\)</span> data points:</li>
</ol>
<table class="caption-top table">
<caption>Regression line calculation exercise.</caption>
<thead>
<tr class="header">
<th>Obs</th>
<th>Y</th>
<th>X</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>4</td>
<td>10</td>
</tr>
<tr class="even">
<td>2</td>
<td>8</td>
<td>-2</td>
</tr>
<tr class="odd">
<td>3</td>
<td>6</td>
<td>7</td>
</tr>
<tr class="even">
<td>4</td>
<td>14</td>
<td>1</td>
</tr>
<tr class="odd">
<td>Sum</td>
<td>32</td>
<td>16</td>
</tr>
</tbody>
</table>
<p>The statistics calculated were:</p>
<p><span class="math inline">\(\bar{y} = 8\)</span>, <span class="math inline">\(\bar{x} = 4\)</span>, <span class="math inline">\(s_Y^2 = 18.6667\)</span>, <span class="math inline">\(s_X^2 = 30\)</span>, <span class="math inline">\(Cov(X,Y) = s_{Y,X} = -16\)</span>, <span class="math inline">\(r = -0.6761\)</span></p>
<p>Please make sure you remember how to calculate these! Use this information to estimate the sample estimates <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>, to obtain the line of best fit for the regression <span class="math inline">\(Y_i = \alpha + \beta X_i + \epsilon_i\)</span> (to 4dp).</p>
<p><span class="math inline">\(b =\)</span> <input class="webex-solveme nospaces" size="7" data-answer="[&quot;-0.5333&quot;,&quot;-.5333&quot;]"></p>
<p><span class="math inline">\(a =\)</span> <input class="webex-solveme nospaces" size="7" data-answer="[&quot;10.1333&quot;]"></p>
<div class="webex-solution">
<button>
Hint
</button>
<p><span class="math inline">\(b=\frac{Cov(X,Y)}{s_X^2}=\frac{-16}{30}=-\frac{8}{15}\)</span></p>
<p><span class="math inline">\(a=\bar{y}-b\cdot \bar{x}=8-(-\frac{8}{15})\cdot 4=\frac{120}{15}+\frac{32}{15}=\frac{152}{15}\)</span></p>
</div>
</div>
</div>
<p>There are a number of issues that need to be stressed here. The first relates, yet again, to the <strong>sample/population</strong> issue. In most cases the data available to run a regression will be sample data. Recall how we previously discussed that the <span class="math inline">\(\bar{x}\)</span> was the sample estimate for some unknown population parameter <span class="math inline">\(\mu\)</span> or the sample variance, <span class="math inline">\(s^2\)</span> was the sample estimate of some unknown population variance, <span class="math inline">\(\sigma^2\)</span>. In the same spirit it turns out that the values of <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> that describe the line of best fit, are sample estimates of some unknown population parameters (usually labelled, <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>).</p>
<p>Also note that <span class="math inline">\(b\)</span> is the slope of the fitted line, <span class="math inline">\(\hat{y}=a+bx\)</span>; i.e., the derivative of <span class="math inline">\(\hat{y}\)</span> with respect to <span class="math inline">\(x\)</span>:</p>
<p><span class="math display">\[\begin{equation*}
    b=d\hat{y}/dx
\end{equation*}\]</span></p>
<p>and measures the increase in <span class="math inline">\(\hat{y}\)</span> for a unit increase in <span class="math inline">\(x\)</span>.</p>
<p>Let us look at the height and weight example for which we established the regression line to be:</p>
<p><span class="math display">\[\begin{equation*}
    \hat{y}=-60.7491+3.2157 ~ x
\end{equation*}\]</span></p>
<p>When you interpret regression results it is extremely important to be aware of the units in which the dependent and explanatory variables are measured. In the case of the Height-Weight example, the explanatory variable (Height, <span class="math inline">\(x\)</span>) is measured in inches (1 inch = 2.54 cm) and the dependent variable (Weight, <span class="math inline">\(y\)</span>) is measured in pounds (1 pound = 1 lbs = 0.454 kg). Do not ask why pounds are abbreviated as lbs. They are.</p>
<p>So, with that knowledge, how would we interpret the estimated slope coefficient, <span class="math inline">\(b=3.2157\)</span>? To interpret this we need to adapt the general formula “<span class="math inline">\(b\)</span> measures the increase in <span class="math inline">\(\hat{y}\)</span> for a unit increase in <span class="math inline">\(x\)</span>”. Applied to this example this implies the following:</p>
<ul>
<li>“The expected weight (<span class="math inline">\(\hat{y}\)</span>) increases by 3.2157 pounds for every height increase of 1 inch.”</li>
<li>“On average weight (<span class="math inline">\(\hat{y}\)</span>) increases by 3.2157 pounds for every height increase of 1 inch.”</li>
</ul>
<p>Recall that expectations are measured with averages, hence both expressions can be used.</p>
<p>The intercept in a regression, here <span class="math inline">\(a = -60.7491\)</span>, sometimes, but not always, can be interpreted. Note that the expected value, when the <span class="math inline">\(x\)</span> variable takes the value of 0 (<span class="math inline">\(x=0\)</span>) is <span class="math inline">\(\hat{y}=a\)</span>, and that is how we interpret the intercept. If someone has a height of 0 inches then we would expect the person to have a weight of -60.7491. This, of course, does not make any sense!!! There are no people with a height of 0. Interpreting the intercept only makes sense if the value of <span class="math inline">\(x=0\)</span> is a sensible value and inside the sample of values of <span class="math inline">\(x\)</span>. In our example the smallest height is 60 inches and the largest height is 74 inches. So even interpreting the results for a height of 40 inches would not make sense as that as well would be outside the sample range.</p>
</section>
</section>
<section id="transformations-of-data" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="transformations-of-data"><span class="header-section-number">5.4</span> Transformations of data</h2>
<p>Numerically, transformations of data can affect the above summary measures. For example, in the weight-height scenario, consider for yourself what would happen to the values of <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> and the correlation if we were to use kilograms and centimetres rather than pounds and inches.</p>
<p>Convert the height of people from inches to cm (1 inch = 2.54 cm), but leaving the weight unchanged, measured in lbs, what are the regression results and how would you interpret the results?</p>
<section id="excel-application-2" class="level4 callout-info" data-number="5.4.0.1">
<h4 data-number="5.4.0.1" class="anchored" data-anchor-id="excel-application-2"><span class="header-section-number">5.4.0.1</span> Excel application</h4>
<p>Video explaining the effect of re-scaling the explanatory variable (YouTube, 8min).</p>
<p>{{ &lt; video https://youtu.be/aDNUHA4h4Xo &gt;}}</p>
<p>The results as presented by EXCEL are shown here:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/EXCEL_Reg2.png" class="img-fluid figure-img"></p>
<figcaption>EXCEL Regression Output.</figcaption>
</figure>
</div>
<p>The estimated regression relationship is (noting that <span class="math inline">\(x\)</span> is now measured in cm):</p>
<p><span class="math display">\[\begin{equation*}
    \hat{y}=-60.7461+1.2660 ~ x
\end{equation*}\]</span></p>
<p>So the slope coefficient is smaller than the original ones which was 3.2157. Let’s calculate the ratio of these two estimates: <span class="math inline">\(3.2157/1.2660 = 2.54\)</span>. As we multiplied the explanatory variable by 2.54, this resulted in the slope coefficient being divided by the same amount. That is no accident.</p>
<p>What you basically did is best described by comparing the two regression models (giving the regression parameters different names). We start by looking at the original model (using the height measurement in inches):</p>
<p><span class="math display">\[\begin{equation*}
    Weight[lbs]_i = \alpha + \beta~ Height[in]_i + \epsilon_i
\end{equation*}\]</span></p>
<p>Now we look at the regression model with height measured in centimeters but then convert it to one where height is measured in inches.</p>
<p><span class="math display">\[\begin{eqnarray*}
    Weight[lbs]_i &amp;=&amp; \gamma + \delta~ Height[cm]_i + v_i \\
    Weight[lbs]_i &amp;=&amp; \gamma + \delta~ (2.54 \cdot Height[in]_i) + v_i  \\
    Weight[lbs]_i &amp;=&amp; \gamma + 2.54 \cdot \delta Height[in]_i + v_i
\end{eqnarray*}\]</span></p>
<p>If you now compare the coefficients you see that <span class="math inline">\(\alpha = \gamma\)</span> and indeed the new intercept is basically identical to the originally estimated constant. Comparing the two models tells us, that the slope coefficients should be related as follows: <span class="math inline">\(\beta =2.54 \cdot \delta\)</span>. And indeed, the original coefficient estimated (in the inches model) is 2.54 times larger than that estimated in the centimeter model.</p>
</section>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Consider the following regression model:</p>
<p><span class="math display">\[\begin{equation*}
    Weight[kg]_i = \eta + \phi~ Height[in]_i + \epsilon_i
\end{equation*}\]</span></p>
<p>How are the coefficients of this model related to those in the original model? Note that 1lbs = 0.454kg.</p>
<ul>
<li>A: $ = 0.454 $ and <span class="math inline">\(\phi = 0.454 \cdot \beta\)</span></li>
<li>B: $ 0.454 = $ and $ 0.454 = $</li>
<li>C: $ = $ and <span class="math inline">\(\phi = 0.454 \cdot \beta\)</span></li>
<li>D: $ = $ and $ 0.454 = $</li>
</ul>
<p>Which of these is correct? <input class="webex-solveme nospaces" size="1" data-answer="[&quot;A&quot;]"></p>
<div class="webex-solution">
<button>
Feedback
</button>
<p>We go through a similar transformation process as in the previous example:</p>
<p><span class="math display">\[\begin{eqnarray*}
    Weight[kg]_i &amp;=&amp; \eta + \phi~ Height[in]_i + u_i \\
    0.454 \cdot Weight[lbs]_i &amp;=&amp; \eta + \phi~ Height[in]_i + u_i   \\
    Weight[lbs]_i &amp;=&amp; \frac{\eta}{0.454} + \frac{\phi}{0.454} ~ Height[in]_i + \frac{1}{0.454}~\epsilon_i   \\
\end{eqnarray*}\]</span></p>
<p>The last line is reformulated into the variables in their original units and hence we can compare coefficients: $ = 0.454 $ and <span class="math inline">\(\phi = 0.454 \cdot \beta\)</span>.</p>
</div>
<p>Estimate the following regression model in EXCEL:</p>
<p><span class="math display">\[\begin{equation*}
    Weight[kg]_i = \eta + \phi~ Height[in]_i + \epsilon_i
\end{equation*}\]</span></p>
<p>Confirm that the estimated coefficients are indeed related to those in the original model as suggested in the previous exercise.</p>
<div class="webex-solution">
<button>
Feedback
</button>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/EXCEL_Reg3.png" class="img-fluid figure-img"></p>
<figcaption>EXCEL Regression Output.</figcaption>
</figure>
</div>
<p>We find the intercept to be <span class="math inline">\(-27.5787\)</span> which is indeed approximately <span class="math inline">\(0.454 \cdot -60.7461\)</span> and the slope to be <span class="math inline">\(1.4599\)</span> which is approximately <span class="math inline">\(0.454 \cdot 3.2157\)</span>.</p>
</div>
</div>
</div>
<p>In the examples above, the scatter plot of the data suggested that, indeed, if there was a relationship between two variables, then that relationship was well described by a linear relationship, i.e.&nbsp;a relationship which graphically follows, approximately, a straight line.</p>
<p>An important matter arises if we find that a scatter of a variable <span class="math inline">\(y\)</span> against another, <span class="math inline">\(x\)</span>, does not appear to reveal a linear relationship. In such cases, linearity may be retrieved if <span class="math inline">\(y\)</span> is plotted against some function of <span class="math inline">\(x\)</span> (e.g., <span class="math inline">\(\log (x)\)</span> or <span class="math inline">\(x^{2}\)</span>, say). Indeed, there may be cases when <span class="math inline">\(Y\)</span> also needs to be transformed in some way. That is to say, transformations of the data (via some mathematical function) may render a non-linear relationship “more” linear.</p>
<p>A particular interesting transformation often used for economics series is a log-log transformation, which means that both dependent and explanatory variables are a log transform. In applied economics studies of demand, the <span class="math inline">\(\log\)</span> of demand <span class="math inline">\((Q)\)</span> is regressed on the <span class="math inline">\(\log\)</span> of price <span class="math inline">\((P)\)</span>, in order to obtain the fitted equation (or relationship). Why does this make sense?</p>
<p>For example, suppose an economic model for the quantity demanded of a good, <span class="math inline">\(Q\)</span>, as a function of its price, <span class="math inline">\(P\)</span>, is postulated as approximately being <span class="math inline">\(Q=\alpha P^{\beta}\)</span> where <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> are unknown parameters, with <span class="math inline">\(\alpha&gt;0\)</span>, <span class="math inline">\(\beta&lt;1\)</span> to ensure a positive downward sloping demand curve.</p>
<p>The nice thing about such a model is that the interpretation of <span class="math inline">\(\beta\)</span> is the price elasticity of demand. Recall that this elasticity is defined as <span class="math inline">\((dQ/Q)/(dP/P)=(dQ/dP)(P/Q)\)</span>. From the above model you can derive that <span class="math inline">\(dQ/dP = \alpha \beta P^{\beta-1}\)</span>. With that information we get the following for the price elasticity in that model:</p>
<p><span class="math display">\[\begin{eqnarray*}
    \frac{dQ}{dP}\frac{P}{Q} &amp;=&amp; \alpha \beta P^{\beta-1}\frac{P}{Q}\\
    &amp;=&amp; \alpha \beta P^{\beta-1}\frac{P}{\alpha P^{\beta}}\\
    &amp;=&amp;  \alpha \beta \frac{P^{\beta}}{\alpha P^{\beta}}\\
    &amp;=&amp; \beta
\end{eqnarray*}\]</span></p>
<p>Why does that make estimating a log-log model so attractive? Take the <span class="math inline">\(log\)</span> on both sides of the postulated model you get <span class="math inline">\(\log(Q)=\alpha^{\ast}+\beta \log(P)\)</span>, where <span class="math inline">\(\alpha^{\ast}=\log(\alpha)\)</span>. Thus, if <span class="math inline">\(n\)</span> observations are available, (<span class="math inline">\(q_{i},p_{i}\)</span>), <span class="math inline">\(i=1,...,n\)</span>, a scatter plot of <span class="math inline">\(\log(q_{i})\)</span> on <span class="math inline">\(\log (p_{i})\)</span> should be approximately linear in nature. This then suggests that a simple regression of <span class="math inline">\(\log (q_{i})\)</span> on <span class="math inline">\(\log (p_{i})\)</span> would provide a direct estimate of the elasticity of demand which is given by the value <span class="math inline">\(\beta\)</span>, namely the estimated slope parameter.</p>
</section>
<section id="worked-example" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Worked Example</h1>
<p>Let’s think about a new example in which estimating a simple regression can provide some good insight. Picture yourself in this Advanced Statistics class and assume that you have also done a previous Advanced Mathematics class. Let’s call the variable representing your grade in Advanced Maths <span class="math inline">\(M\)</span> and you are currently studying for your Advanced Statistics course (yes, if you are reading this you are!! well done). Let’s call the variable for that grade <span class="math inline">\(S\)</span>. At this stage you have your grade for Maths, but not the one for Stats.</p>
<p>Let’s create a model with which we can predict your grade in Advanced Statistics. In the datafile “<a href="https://github.com/datasquad/StatisticsNotesBook/raw/refs/heads/master/data/Maths%20and%20Stats%20grades.xlsx">Maths and Stats grades.xlsx</a>” we have observations for 801 previous students for whom we know the grades for both <span class="math inline">\(M\)</span> and <span class="math inline">\(S\)</span>, in other words, we have a sample (<span class="math inline">\(m_{i},s_{i}\)</span>), <span class="math inline">\(i=1,...,n=801\)</span>. (Note: the grades and names in the file are random but posess identical features as the real data in previous academic years.)</p>
<p>Let’s first look at a scatter plot for these data.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/scatter_grades.png" class="img-fluid figure-img"></p>
<figcaption>Advanced Maths and Stats grades for 801 fictional students.</figcaption>
</figure>
</div>
<p>There are a number of observations from this plot:</p>
<ul>
<li>Each point represents one student and displays that students Advanced Maths and Advanced Stats grade, e.g.&nbsp;Ronan who had a grade of 29 in Advanced Maths and a grade of 66 in Advanced Stats)</li>
<li>Clearly there is a positive relationship, students with higher grades in Maths tend to get higher grades in Stats as well.</li>
<li>However, even for students with the same Advanced Maths grade (see the blue dots which represent the students with an Advanced Maths grade of 50) there is large range of Advanced Stats grade outcomes (here from 29 to 80).</li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Which of the following two regression specifications is most sensible? <select class="webex-select"><option value="blank"></option><option value="answer">A</option><option value="">B</option></select></p>
<ul>
<li>A: <span class="math inline">\(s_i = \alpha + \beta~ m_i + \epsilon_i\)</span></li>
<li>B: <span class="math inline">\(m_i = \alpha + \beta~ s_i + \epsilon_i\)</span></li>
</ul>
<p>Estimate your chosen regression.</p>
<p>You get it right if the “Multiple R” statistics is 0.4611743.</p>
<p>What is the estimated intercept? <span class="math inline">\(a =\)</span> <input class="webex-solveme nospaces" size="6" data-answer="[&quot;26.431&quot;]"></p>
<p>What is the estimated slope coefficient? <span class="math inline">\(b =\)</span> <input class="webex-solveme nospaces" size="6" data-answer="[&quot;0.5418&quot;,&quot;.5418&quot;]"></p>
<p>What is the interpretation of the estimated intercept? (one correct answer only)</p>
<div id="radio_QLTKOCDSPC" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_QLTKOCDSPC" value=""> <span>A student who got a grade of 26 in Advanced Mathematics should expect to get a grade of 0 in Advanced Statistics.</span></label><label><input type="radio" autocomplete="off" name="radio_QLTKOCDSPC" value=""> <span>A student who got a grade of 26 in Advanced Mathematics should expect to get a grade of 26 in Advanced Statistics.</span></label><label><input type="radio" autocomplete="off" name="radio_QLTKOCDSPC" value=""> <span>A student who got a grade of 0 in Advanced Mathematics should expect to get a grade of 26 in Advanced Statistics.</span></label><label><input type="radio" autocomplete="off" name="radio_QLTKOCDSPC" value="answer"> <span>One should not interpret the intercept as no grades close to 0 in Advanced Maths were included in the sample.</span></label>
</div>
<div class="webex-solution">
<button>
Feedback
</button>
<p>You should not interpret the intercept if the value of 0 for the explanatory variable (here the Advanced Maths grade) is not included inside the range of the observed values.</p>
</div>
<p>What is the interpretation of the estimated slope coefficient? (one correct answer only)</p>
<div id="radio_WREJJMSGOX" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_WREJJMSGOX" value="answer"> <span>For every extra grade in Advanced Maths students should expect an additional 0.54 grade in Advanced Statistics.</span></label><label><input type="radio" autocomplete="off" name="radio_WREJJMSGOX" value=""> <span>For every extra grade in Advanced Maths students will get an additional 0.54 grade in Advanced Statistics.</span></label><label><input type="radio" autocomplete="off" name="radio_WREJJMSGOX" value=""> <span>In order to get an additional grade in Advanced Statistics you should improve your Advanced Maths grae by 0.54.</span></label><label><input type="radio" autocomplete="off" name="radio_WREJJMSGOX" value=""> <span>54% of the variation in the Advanced Statistics grades can be explained by variation in the Advanced Mathematics grades.</span></label>
</div>
<div class="webex-solution">
<button>
Hint
</button>
<p>Apply the generic: “<span class="math inline">\(b\)</span> measures the increase in <span class="math inline">\(\hat{y}\)</span> for a unit increase in <span class="math inline">\(x\)</span>”. So the correct answer is the first.</p>
</div>
<p>What percentage of the variation in the Advanced Statistics grades is explained by this model?</p>
<p><span class="math inline">\(R^2 =\)</span> <input class="webex-solveme nospaces" size="6" data-answer="[&quot;0.2127&quot;,&quot;.2127&quot;]"></p>
<p>If you had an Advanced Mathematics grade of 50, what would be your expected Advanced Statistics grade?</p>
<p><span class="math inline">\(\hat{s}=\)</span> <input class="webex-solveme nospaces" size="6" data-answer="[&quot;53.521&quot;]"></p>
<div class="webex-solution">
<button>
Hint
</button>
<p><span class="math inline">\(\hat{s}=\)</span> 26.4310 + 0.5418 = 53.521$</p>
</div>
</div>
</div>
<section id="additional-resources-1" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="additional-resources-1"><span class="header-section-number">6.1</span> Additional resources</h2>
<ul>
<li><a href="https://www.khanacademy.org/math/probability/regression/regression-correlation/v/squared-error-of-regression-line">Khan Academy: Setup of the OLS problem and how to proof that the above formulae for <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span></a> and four follow on clips - click on “up next” at the end of each clip). But be careful, in his video Salman Khan uses <span class="math inline">\(m\)</span> for what we call <span class="math inline">\(b\)</span> and <span class="math inline">\(b\)</span> for what we call <span class="math inline">\(a\)</span>. Life is never easy!</li>
<li><a href="http://www.youtube.com/watch?v=AHAlqJTrPHE&amp;list=PLW7MJJThJQQs3djo1EL6KCRFeCa6wpfYY">Link to a full (55min) undergraduate, introductory lecture on regression</a>. Minutes 1 to 22 are relevant for this lesson.</li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script src="include/webex.js"></script>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./descriptive_stats.html" class="pagination-link" aria-label="Numerical Descriptive Statistics">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Numerical Descriptive Statistics</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./DealingWithDataSets.html" class="pagination-link" aria-label="Dealing with real life datasets">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Dealing with real life datasets</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>